import{v as K,c as Z,E as P,o as G,p as Q,w as W,q as X,x as ee,y as te,z as oe,r as ne}from"./_element-plus-8e8eff9a.js";import{a6 as q,af as le}from"./__vendor-2ef38daa.js";import{u as j,l as A,e as L,d as U,f as ae}from"../js2/app-33156c1d.js";import{r as b,z as re,x as se,i as ie,o as Y,c as O,E as o,a3 as s,u as i,a7 as R,a as y,a8 as ce,a6 as de}from"./_@vue-e3a2634f.js";import"./_@element-plus-27eae3dd.js";const B=q.create();let _=null;B.interceptors.request.use(e=>{var g,a;const{token:n,axiosPromiseArr:p}=j();return e.cancelToken=new q.CancelToken(c=>{p.push({url:e.url,cancel:c})}),e.headers.AUTHORIZE_TOKEN=n,"get".includes((g=e.method)==null?void 0:g.toLowerCase())&&(e.params=e.data),((a=e.reqLoading)==null||a)&&(_=K.service({lock:!0,fullscreen:!0,text:"loading...",background:"rgba(0, 0, 0, 0.3)"})),e},e=>{Promise.reject(e)});B.interceptors.response.use(e=>{var c;if(_&&_&&_.close(),["application/zip","zip","blob","arraybuffer"].includes(e.headers["content-type"]))return e;const{code:n,msg:p}=e.data,g="0,200,20000",a="401,403";return g.includes(n)?e.data:(a.includes(n)&&Z.confirm(A("relogin_title"),{confirmButtonText:A("relogin"),closeOnClickModal:!1,showCancelButton:!1,showClose:!1,type:"warning"}).then(()=>{j().resetStateAndToLogin()}),(c=e.config)!=null&&c.isNotTipErrorMsg||P.error({message:p,duration:2*1e3}),Promise.reject(p))},e=>(_&&_&&_.close(),console.log(e),P.error({message:e,duration:2*1e3}),Promise.reject(e)));function z(e){return B({baseURL:"http://vapi.youlai.tech",timeout:8e3,...e})}const ue=(e,n)=>{const p=b([]),g=b(0),a=b(1),c=b(20),E=t=>{const l=Object.assign({pageNum:a.value,pageSize:c.value},JSON.parse(JSON.stringify(e)));Object.keys(l).forEach(d=>{["",null,void 0,Number.NaN].includes(l[d])&&delete l[d],t.method==="get"&&(Array.isArray(l[d])&&delete l[d],l[d]instanceof Object&&delete l[d])});const f={data:l,...t};return z(f)},k=t=>{t&&t.length===2?(e.startTime=t[0],e.endTime&&(e.endTime=le(t[1]).endOf("day").format("YYYY-MM-DD HH:mm:ss"))):(e.startTime="",e.endTime="")},T=t=>{a.value=t,n()},D=t=>{c.value=t,n()},C=()=>{a.value=1,n()},v=b([]);return{pageNum:a,pageSize:c,totalPage:g,tableListData:p,tableListReq:E,dateRangePacking:k,multipleSelection:v,handleSelectionChange:t=>{v.value=t},handleCurrentChange:T,handleSizeChange:D,resetPageReq:C,multiDelBtnDill:t=>{let l=[],f="";if(l=v.value.map(m=>(f=`${f+m.id},`,m.id)),l.length===0){L("selection is required","warning");return}const d=f.length-1;U("delete",`Are you confirm to delete \u3010${f.slice(0,d)}\u3011 ?`).then(()=>{z({data:l,method:"DELETE",bfLoading:!0,...t}).then(()=>{L("Delete Success"),C()})})},tableDelDill:(t,l)=>{U("Confirm",`Are you sure to delete\u3010${t.id}\u3011?`).then(()=>{z(l).then(()=>{C(),L(`\u3010${t.id}\u3011delete success`)})})}}},pe={class:"mt-10px query-page-style"},ge={class:"rowES mb-10px"},me=y("span",{style:{"vertical-align":"middle"}},"multiDel",-1),fe=["onClick"],he={class:"table-operation-btn"},_e=["onClick"],Ce={key:0,class:"rowCC mt-20px"},Ee=re({__name:"index",setup(e){const n=se({log:"",pageUrl:"",startEndArr:""}),p=()=>{v({url:"/integration-front/errorCollection/selectPage",method:"get"}).then(({data:r})=>{C.value=r.records,D.value=r.total})},g=b(),a=()=>{g.value.resetFields(),x(["",""]),l()},c=()=>{f({url:"/integration-front/errorCollection/deleteBatchIds",method:"delete",bfLoading:!0})},E=m=>{const r={url:"/integration-front/errorCollection/deleteById",params:{id:m.id},method:"delete"};d(m,r)};ie(()=>{p()});let{pageNum:k,pageSize:T,totalPage:D,tableListData:C,tableListReq:v,dateRangePacking:x,handleSelectionChange:N,handleCurrentChange:V,handleSizeChange:t,resetPageReq:l,multiDelBtnDill:f,tableDelDill:d}=ue(n,p);return(m,r)=>{const M=G,w=Q,$=W,S=ne,H=X,h=ee,F=te,J=oe;return Y(),O("div",pe,[o(H,{ref_key:"refSearchForm",ref:g,inline:!0,model:n},{default:s(()=>[o(w,{prop:"log"},{default:s(()=>[o(M,{modelValue:n.log,"onUpdate:modelValue":r[0]||(r[0]=u=>n.log=u),class:"w-150px",placeholder:"log"},null,8,["modelValue"])]),_:1}),o(w,{prop:"pageUrl"},{default:s(()=>[o(M,{modelValue:n.pageUrl,"onUpdate:modelValue":r[1]||(r[1]=u=>n.pageUrl=u),class:"w-200px",placeholder:"pageUrl"},null,8,["modelValue"])]),_:1}),o(w,{prop:"startEndArr"},{default:s(()=>[o($,{modelValue:n.startEndArr,"onUpdate:modelValue":r[2]||(r[2]=u=>n.startEndArr=u),type:"daterange",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD HH:mm:ss",class:"w-250px","range-separator":"-","start-placeholder":"startDate","end-placeholder":"endDate",onChange:i(x)},null,8,["modelValue","onChange"])]),_:1}),o(w,null,{default:s(()=>[o(S,{type:"primary",onClick:i(l)},{default:s(()=>[R("search")]),_:1},8,["onClick"]),o(S,{type:"primary",onClick:a},{default:s(()=>[R("reset")]),_:1})]),_:1})]),_:1},8,["model"]),y("div",ge,[o(S,{type:"primary",onClick:c},{default:s(()=>[me]),_:1})]),o(F,{id:"resetElementDialog",ref:"refuserTable",height:"calc(100vh - 260px)",border:"",data:i(C),onSelectionChange:i(N)},{default:s(()=>[o(h,{type:"selection",align:"center",width:"50"}),o(h,{align:"center",prop:"errorLog",label:"Log","min-width":"250"},{default:s(({row:u})=>[y("div",{class:"btn-click-style",onClick:I=>i(ae)(u.errorLog)},ce(u.errorLog)+"}",9,fe)]),_:1}),o(h,{"show-overflow-tooltip":"",align:"center",prop:"pageUrl",label:"Page URL","min-width":"120"}),o(h,{"show-overflow-tooltip":"",align:"center",prop:"version",label:"Version","min-width":"80"}),o(h,{"show-overflow-tooltip":"",align:"center",prop:"browserType",label:"Browser","min-width":"120"}),o(h,{"show-overflow-tooltip":"",align:"center",prop:"createTime",label:"Created At","min-width":"120"}),o(h,{fixed:"right",align:"center",label:"Action",width:"72"},{default:s(({row:u})=>[y("div",he,[y("span",{onClick:I=>E(u)},"Delete",8,_e)])]),_:1})]),_:1},8,["height","data","onSelectionChange"]),i(D)>=10?(Y(),O("div",Ce,[o(J,{"current-page":i(k),"page-sizes":[10,20,50,100],"page-size":i(T),layout:"total, sizes, prev, pager, next, jumper",total:i(D),onSizeChange:i(t),onCurrentChange:i(V)},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])):de("",!0)])}}});export{Ee as default};
//# sourceMappingURL=index-2964dba5.js.map
