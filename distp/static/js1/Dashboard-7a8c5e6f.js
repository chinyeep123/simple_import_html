import{v as ne,c as ie,E as x,z as se,q as C,l as re,m as de,n as ce,p as ue,o as pe,x as me,y as fe,A as ge,d as _e,B as ye,C as he,s as be,t as xe,r as ve,u as we}from"./_element-plus-8e8eff9a.js";import{a6 as V}from"./__vendor-2ef38daa.js";import{u as j,l as U,_ as Ce}from"../js2/app-33156c1d.js";import{S as ke,T as Ee,U as De}from"./_@element-plus-27eae3dd.js";import{z as M,j as F,o as E,c as A,E as o,u as l,p as N,_ as ze,r as k,x as Se,y as Fe,i as Te,a3 as a,a7 as h,a4 as Le,a2 as R,a6 as Ie,a as D}from"./_@vue-e3a2634f.js";const T=V.create();let _=null;T.interceptors.request.use(e=>{var t,c;const{token:n,axiosPromiseArr:i}=j();return e.cancelToken=new V.CancelToken(u=>{i.push({url:e.url,cancel:u})}),e.headers.AUTHORIZE_TOKEN=n,"get".includes((t=e.method)==null?void 0:t.toLowerCase())&&(e.params=e.data),((c=e.reqLoading)==null||c)&&(_=ne.service({lock:!0,fullscreen:!0,text:"loading...",background:"rgba(0, 0, 0, 0.3)"})),e},e=>{Promise.reject(e)});T.interceptors.response.use(e=>{var u;if(_&&_&&_.close(),["application/zip","zip","blob","arraybuffer"].includes(e.headers["content-type"]))return e;const{code:n,msg:i}=e.data,t="0,200,20000",c="401,403";return t.includes(e.status)?e:(c.includes(n)&&ie.confirm(U("relogin_title"),{confirmButtonText:U("relogin"),closeOnClickModal:!1,showCancelButton:!1,showClose:!1,type:"warning"}).then(()=>{j().resetStateAndToLogin()}),(u=e.config)!=null&&u.isNotTipErrorMsg||x.error({message:i,duration:2*1e3}),Promise.reject(i))},e=>(_&&_&&_.close(),x.error({message:e,duration:2*1e3}),Promise.reject(e)));function L(e){return T({baseURL:"/",timeout:8e3,...e})}const Be=e=>L({url:"/api/products",method:"get",params:e}),Pe=e=>{const n=new FormData;return n.append("file",e),L({url:"/api/products/import",method:"post",data:n,headers:{"Content-Type":"multipart/form-data"}})};function Ue(){return L({url:"/api/products/import/template/download",method:"get",responseType:"arraybuffer"})}const Ne=M({__name:"index",props:{total:{required:!0,type:Number,default:0},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},emits:["update:page","update:limit","pagination"],setup(e,{emit:n}){const i=e,t=F({get:()=>i.page,set:d=>{n("update:page",d)}}),c=F({get(){return i.limit},set(d){n("update:limit",d)}});function u(d){n("pagination",{page:t,limit:d}),i.autoScroll}function y(d){t.value=d,n("pagination",{page:d,limit:i.limit}),i.autoScroll}return(d,f)=>{const I=se;return E(),A("div",{class:ze([{hidden:e.hidden},"pagination-container"])},[o(I,{background:e.background,"current-page":l(t),"onUpdate:current-page":f[0]||(f[0]=b=>N(t)?t.value=b:null),"page-size":l(c),"onUpdate:page-size":f[1]||(f[1]=b=>N(c)?c.value=b:null),layout:e.layout,"page-sizes":e.pageSizes,total:e.total,onSizeChange:u,onCurrentChange:y},null,8,["background","current-page","page-size","layout","page-sizes","total"])],2)}}});const Re=Ce(Ne,[["__scopeId","data-v-001d26f5"]]),Ve={class:"app-container"},je=D("div",{class:"el-upload__text"},[h(" Drop your file here or "),D("em",null,"click to upload")],-1),Me=D("div",{class:"el-upload__tip"},"xls/xlsx files",-1),Ae={class:"dialog-footer"},He=M({__name:"Dashboard",setup(e){k(C),k(C);const n=k(C),i=k("");F(()=>d.value.filter(s=>!i.value||s.name.toLowerCase().includes(i.value.toLowerCase())));const t=Se({loading:!0,ids:[],total:0,productList:[],dialog:{visible:!1},queryParams:{pageNum:1,pageSize:10},rules:{},importDialog:{title:"Product Import",visible:!1},importFormData:{},excelFile:void 0,excelFilelist:[]}),{ids:c,loading:u,queryParams:y,productList:d,total:f,dialog:I,rules:b,importDialog:v,importFormData:O,excelFilelist:q}=Fe(t);function z(){t.loading=!0,Be(t.queryParams).then(({data:s})=>{t.productList=s.data,t.total=s.meta.total,t.loading=!1})}function X(s){t.ids=s.map(r=>r.id)}function Q(){Ue().then(s=>{const r=new Blob([s.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8"}),p=document.createElement("a"),w=window.URL.createObjectURL(r);p.href=w,p.download=decodeURI(s.headers["content-disposition"].split(";")[1].split("=")[1]),document.body.appendChild(p),p.click(),document.body.removeChild(p),window.URL.revokeObjectURL(w)})}async function $(){v.value.visible=!0}function H(s){if(!/\.(xlsx|xls|XLSX|XLS)$/.test(s.name))return x.warning("upload file must be Excel format ex: xlsx, xls"),t.excelFile=void 0,t.excelFilelist=[],!1;t.excelFile=s.raw}function K(){n.value.validate(s=>{if(s){if(!t.excelFile)return x.warning("import excel file cannot be empty"),!1;Pe(t.excelFile).then(r=>{x.success(r.data),S(),z()})}})}function S(){t.importDialog.visible=!1,t.excelFile=void 0,t.excelFilelist=[],n.value.resetFields()}return Te(()=>{z()}),(s,r)=>{const p=re,w=de,Z=ce,B=ue,G=pe,m=me,J=fe,W=ge,Y=be,ee=xe,te=_e,oe=ye,P=ve,ae=we,le=he;return E(),A("div",Ve,[o(ee,{gutter:20},{default:a(()=>[o(Y,{span:24},{default:a(()=>[o(W,{shadow:"never"},{header:a(()=>[o(B,null,{default:a(()=>[o(Z,{"split-button":""},{dropdown:a(()=>[o(w,null,{default:a(()=>[o(p,{icon:l(ke),onClick:Q},{default:a(()=>[h("Download Sample")]),_:1},8,["icon"]),o(p,{icon:l(Ee),onClick:$},{default:a(()=>[h("Import")]),_:1},8,["icon"])]),_:1})]),default:a(()=>[h(" Import ")]),_:1})]),_:1})]),default:a(()=>[Le((E(),R(J,{data:l(d),onSelectionChange:X},{header:a(()=>[o(G,{modelValue:i.value,"onUpdate:modelValue":r[0]||(r[0]=g=>i.value=g),size:"small",placeholder:"Type to search"},null,8,["modelValue"])]),default:a(()=>[o(m,{type:"selection",width:"50",align:"center"}),o(m,{key:"id",label:"ID",align:"center",prop:"id",width:"100"}),o(m,{key:"product_id",label:"Product ID",align:"center",prop:"product_id"}),o(m,{key:"type",label:"Types",align:"center",prop:"type"}),o(m,{key:"brand",label:"Brand",align:"center",prop:"brand"}),o(m,{key:"model",label:"Model",align:"center",prop:"model"}),o(m,{key:"capacity",label:"Capacity",align:"center",prop:"capacity"}),o(m,{key:"quantity",label:"Quantity",align:"center",prop:"quantity"})]),_:1},8,["data"])),[[le,l(u)]]),l(f)>0?(E(),R(Re,{key:0,total:l(f),page:l(y).pageNum,"onUpdate:page":r[1]||(r[1]=g=>l(y).pageNum=g),limit:l(y).pageSize,"onUpdate:limit":r[2]||(r[2]=g=>l(y).pageSize=g),onPagination:z},null,8,["total","page","limit"])):Ie("",!0)]),_:1})]),_:1})]),_:1}),o(ae,{title:l(v).title,modelValue:l(v).visible,"onUpdate:modelValue":r[3]||(r[3]=g=>l(v).visible=g),width:"600px","append-to-body":"",onClose:S},{footer:a(()=>[D("div",Ae,[o(P,{type:"primary",onClick:K},{default:a(()=>[h("Confirm")]),_:1}),o(P,{onClick:S},{default:a(()=>[h("Cancel")]),_:1})])]),default:a(()=>[o(l(C),{ref_key:"importFormRef",ref:n,model:l(O),rules:l(b),"label-width":"80px"},{default:a(()=>[o(B,{label:"Excel"},{default:a(()=>[o(oe,{class:"upload-demo",action:"",drag:"","auto-upload":!1,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel","file-list":l(q),"on-change":H,limit:1},{tip:a(()=>[Me]),default:a(()=>[o(te,{class:"el-icon--upload"},{default:a(()=>[o(l(De))]),_:1}),je]),_:1},8,["file-list"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{He as default};
//# sourceMappingURL=Dashboard-7a8c5e6f.js.map
